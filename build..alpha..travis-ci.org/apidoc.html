<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/oncletom/tld.js"

    >tldjs (v1.7.0)</a>
</h1>
<h4>JavaScript API to work against complex domain names, subdomains and URIs.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs">module tldjs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule">
            function <span class="apidocSignatureSpan">tldjs.</span>rule
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld">
            function <span class="apidocSignatureSpan">tldjs.</span>tld
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>publicsuffix_org</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>rule.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>rules</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>tld.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>update</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">tldjs.</span>validHosts</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.publicsuffix_org">module tldjs.publicsuffix_org</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.publicsuffix_org.domainBuilder">
            function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>domainBuilder
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.publicsuffix_org.filterRow">
            function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>filterRow
            <span class="apidocSignatureSpan">(row)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.publicsuffix_org.parse">
            function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>parse
            <span class="apidocSignatureSpan">(body)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.rule">module tldjs.rule</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.rule">
            function <span class="apidocSignatureSpan">tldjs.</span>rule
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.rule.prototype">module tldjs.rule.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.prototype.getExceptionPattern">
            function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getExceptionPattern
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.prototype.getNormalPattern">
            function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getNormalPattern
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.prototype.getNormalXld">
            function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getNormalXld
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.prototype.getPattern">
            function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getPattern
            <span class="apidocSignatureSpan">(before, after)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.rule.prototype.getWildcardPattern">
            function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getWildcardPattern
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.tld">module tldjs.tld</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.tld">
            function <span class="apidocSignatureSpan">tldjs.</span>tld
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.cleanHostValue">
            function <span class="apidocSignatureSpan">tldjs.tld.</span>cleanHostValue
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.escapeRegExp">
            function <span class="apidocSignatureSpan">tldjs.tld.</span>escapeRegExp
            <span class="apidocSignatureSpan">(s)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.extractTldFromHost">
            function <span class="apidocSignatureSpan">tldjs.tld.</span>extractTldFromHost
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.getCandidateRule">
            function <span class="apidocSignatureSpan">tldjs.tld.</span>getCandidateRule
            <span class="apidocSignatureSpan">(host, rules, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.init">
            function <span class="apidocSignatureSpan">tldjs.tld.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.tld.prototype">module tldjs.tld.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.getDomain">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getDomain
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.getPublicSuffix">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getPublicSuffix
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.getRulesForTld">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getRulesForTld
            <span class="apidocSignatureSpan">(tld, default_rule)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.getSubdomain">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getSubdomain
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.isValid">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>isValid
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.tld.prototype.tldExists">
            function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>tldExists
            <span class="apidocSignatureSpan">(host)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.tldjs.update">module tldjs.update</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.tldjs.update.run">
            function <span class="apidocSignatureSpan">tldjs.update.</span>run
            <span class="apidocSignatureSpan">(done)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">tldjs.update.</span>providerUrl</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs" id="apidoc.module.tldjs">module tldjs</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.rule" id="apidoc.element.tldjs.rule">
        function <span class="apidocSignatureSpan">tldjs.</span>rule
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Rule(data){
  data = data || {};

  this.exception = data.exception || false;
  this.firstLevel = data.firstLevel || &#x27;&#x27;;
  this.secondLevel = data.secondLevel || null;
  this.isHost = data.isHost || false;
  this.source = data.source || &#x27;&#x27;;
  this.wildcard = data.wildcard || false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld" id="apidoc.element.tldjs.tld">
        function <span class="apidocSignatureSpan">tldjs.</span>tld
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function tld() {
<span class="apidocCodeCommentSpan">  /* jshint validthis: true */
</span>  this.validHosts = [];
  this.rules = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>














</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.publicsuffix_org" id="apidoc.module.tldjs.publicsuffix_org">module tldjs.publicsuffix_org</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.publicsuffix_org.domainBuilder" id="apidoc.element.tldjs.publicsuffix_org.domainBuilder">
        function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>domainBuilder
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">domainBuilder = function (row){
  var rule = {};

  row = punycode.toASCII(row.trim());

  //setting initial rule
  rule.source = row;

  //exception
  row = row.replace(/^!(.+)$/, function(m, tld){
    rule.exception = true;

    return tld;
  });

  //wildcard
  row = row.replace(/^(\*\.)(.+)$/, function(m, dummy, tld){
    rule.wildcard = true;

    return tld;
  });

  //splitting domains
  row.replace(/^((.+)\.)?([^\.]+)$/, function(m, dummy, secondLevel, firstLevel){
    rule.firstLevel = firstLevel;

    if (secondLevel){
      rule.secondLevel = secondLevel;
    }

  });

  return rule;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.publicsuffix_org.filterRow" id="apidoc.element.tldjs.publicsuffix_org.filterRow">
        function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>filterRow
        <span class="apidocSignatureSpan">(row)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filterRow = function (row) {
  return (/^\/\//).test(row) ? null : row;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.publicsuffix_org.parse" id="apidoc.element.tldjs.publicsuffix_org.parse">
        function <span class="apidocSignatureSpan">tldjs.publicsuffix_org.</span>parse
        <span class="apidocSignatureSpan">(body)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (body){
  return (body+&#x27;&#x27;)
    .split(/\n/m)
    .filter(PublicSuffixOrgParser.filterRow)
    .map(PublicSuffixOrgParser.domainBuilder);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// scheme      = ALPHA *( ALPHA / DIGIT / &#x22;+&#x22; / &#x22;-&#x22; / &#x22;.&#x22; )
var hasPrefixRE = /^(([a-z][a-z0-9+.-]*)?:)?\/\//;
var invalidHostnameChars = /[^A-Za-z0-9.-]/;

tld.cleanHostValue = function cleanHostValue(value){
  value = trim(value).toLowerCase();

  var parts = URL.<span class="apidocCodeKeywordSpan">parse</span>(hasPrefixRE.test(value) ? value : &#x27;//&#x27; + value, null
, true);

  if (parts.hostname &#x26;&#x26; !invalidHostnameChars.test(parts.hostname)) { return parts.hostname; }
  if (!invalidHostnameChars.test(value)) { return value; }
  return &#x27;&#x27;;
};

/**
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.rule" id="apidoc.module.tldjs.rule">module tldjs.rule</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.rule.rule" id="apidoc.element.tldjs.rule.rule">
        function <span class="apidocSignatureSpan">tldjs.</span>rule
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Rule(data){
  data = data || {};

  this.exception = data.exception || false;
  this.firstLevel = data.firstLevel || &#x27;&#x27;;
  this.secondLevel = data.secondLevel || null;
  this.isHost = data.isHost || false;
  this.source = data.source || &#x27;&#x27;;
  this.wildcard = data.wildcard || false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.rule.prototype" id="apidoc.module.tldjs.rule.prototype">module tldjs.rule.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.rule.prototype.getExceptionPattern" id="apidoc.element.tldjs.rule.prototype.getExceptionPattern">
        function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getExceptionPattern
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExceptionPattern(){
  return (this.secondLevel || &#x27;&#x27;) + &#x27;\\.&#x27; + this.firstLevel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Rule.prototype.getPattern = function getPattern(before, after){
var pattern = &#x27;&#x27;;

before = (before === undefined) ? &#x27;(&#x27;: before+&#x27;&#x27;;
after = (after === undefined) ? &#x27;)$&#x27;: after+&#x27;&#x27;;

if (this.exception === true){
  pattern = this.<span class="apidocCodeKeywordSpan">getExceptionPattern</span>();
}
else if (this.isHost === true) {
  pattern = this.firstLevel;
}
else{
  pattern = &#x27;[^\\.]+&#x27; + (this.wildcard ? this.getWildcardPattern() : this.getNormalPattern());
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.rule.prototype.getNormalPattern" id="apidoc.element.tldjs.rule.prototype.getNormalPattern">
        function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getNormalPattern
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getNormalPattern(){
  return (this.secondLevel ? &#x27;\\.&#x27; + this.secondLevel : &#x27;&#x27;) + &#x27;\\.&#x27; + this.firstLevel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (this.exception === true){
    pattern = this.getExceptionPattern();
  }
  else if (this.isHost === true) {
    pattern = this.firstLevel;
  }
  else{
    pattern = &#x27;[^\\.]+&#x27; + (this.wildcard ? this.getWildcardPattern() : this.<span class="apidocCodeKeywordSpan">getNormalPattern
</span>());
  }

  return before + pattern + after;
};

module.exports = Rule;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.rule.prototype.getNormalXld" id="apidoc.element.tldjs.rule.prototype.getNormalXld">
        function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getNormalXld
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getNormalXld(){
  return (this.secondLevel ? &#x27;.&#x27; + this.secondLevel : &#x27;&#x27;) + &#x27;.&#x27; + this.firstLevel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Returns a pattern suitable for wildcard rule
* Mostly for internal use
*
* @return {String}
*/
Rule.prototype.getWildcardPattern = function getWildcardPattern(){
 return &#x27;\\.[^\\.]+&#x27; + this.<span class="apidocCodeKeywordSpan">getNormalXld</span>().replace(/\./g, &#x27;\\.&#x27;);
};

/**
* Returns a pattern suitable for exception rule
* Mostly for internal use
*
* @return {String}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.rule.prototype.getPattern" id="apidoc.element.tldjs.rule.prototype.getPattern">
        function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getPattern
        <span class="apidocSignatureSpan">(before, after)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getPattern(before, after){
  var pattern = &#x27;&#x27;;

  before = (before === undefined) ? &#x27;(&#x27;: before+&#x27;&#x27;;
  after = (after === undefined) ? &#x27;)$&#x27;: after+&#x27;&#x27;;

  if (this.exception === true){
    pattern = this.getExceptionPattern();
  }
  else if (this.isHost === true) {
    pattern = this.firstLevel;
  }
  else{
    pattern = &#x27;[^\\.]+&#x27; + (this.wildcard ? this.getWildcardPattern() : this.getNormalPattern());
  }

  return before + pattern + after;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  rules = this.getRulesForTld(hostTld, new Rule({&#x22;firstLevel&#x22;: hostTld, &#x22;isHost&#x22;: this.validHosts.indexOf(hostTld
) !== -1}));
  rule = tld.getCandidateRule(host, rules);

  if (rule === null) {
    return null;
  }

  host.replace(new RegExp(rule.<span class="apidocCodeKeywordSpan">getPattern</span>()), function (m, d) {
    domain = d;
  });

  return domain;
};

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.rule.prototype.getWildcardPattern" id="apidoc.element.tldjs.rule.prototype.getWildcardPattern">
        function <span class="apidocSignatureSpan">tldjs.rule.prototype.</span>getWildcardPattern
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getWildcardPattern(){
  return &#x27;\\.[^\\.]+&#x27; + this.getNormalXld().replace(/\./g, &#x27;\\.&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (this.exception === true){
    pattern = this.getExceptionPattern();
  }
  else if (this.isHost === true) {
    pattern = this.firstLevel;
  }
  else{
    pattern = &#x27;[^\\.]+&#x27; + (this.wildcard ? this.<span class="apidocCodeKeywordSpan">getWildcardPattern</span>() : this
.getNormalPattern());
  }

  return before + pattern + after;
};

module.exports = Rule;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.tld" id="apidoc.module.tldjs.tld">module tldjs.tld</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.tld.tld" id="apidoc.element.tldjs.tld.tld">
        function <span class="apidocSignatureSpan">tldjs.</span>tld
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function tld() {
<span class="apidocCodeCommentSpan">  /* jshint validthis: true */
</span>  this.validHosts = [];
  this.rules = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.cleanHostValue" id="apidoc.element.tldjs.tld.cleanHostValue">
        function <span class="apidocSignatureSpan">tldjs.tld.</span>cleanHostValue
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cleanHostValue(value){
  value = trim(value).toLowerCase();

  var parts = URL.parse(hasPrefixRE.test(value) ? value : &#x27;//&#x27; + value, null, true);

  if (parts.hostname &#x26;&#x26; !invalidHostnameChars.test(parts.hostname)) { return parts.hostname; }
  if (!invalidHostnameChars.test(value)) { return value; }
  return &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api
 * @param {string} host
 * @return {boolean}
 */
tld.prototype.tldExists = function tldExists(host){
var hostTld;

host = tld.<span class="apidocCodeKeywordSpan">cleanHostValue</span>(host);

// Easy case, it&#x27;s a TLD
if (this.rules[host]){
  return true;
}

// Popping only the TLD of the hostname
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.escapeRegExp" id="apidoc.element.tldjs.tld.escapeRegExp">
        function <span class="apidocSignatureSpan">tldjs.tld.</span>escapeRegExp
        <span class="apidocSignatureSpan">(s)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeRegExp(s) {
  return String(s).replace(/([.*+?^=!:${}()|\[\]\/\\])/g, &#x22;\\$1&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 domain = this.getDomain(host);

 // No domain found? Just abort, abort!
 if (domain === null){
   return null;
 }

 r = &#x27;\\.?&#x27;+ tld.<span class="apidocCodeKeywordSpan">escapeRegExp</span>(domain)+&#x27;$&#x27;;
 subdomain = host.replace(new RegExp(r, &#x27;i&#x27;), &#x27;&#x27;);

 return subdomain;
};

/**
* Checking if a host string is valid
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.extractTldFromHost" id="apidoc.element.tldjs.tld.extractTldFromHost">
        function <span class="apidocSignatureSpan">tldjs.tld.</span>extractTldFromHost
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function extractTldFromHost(host){
  return host.split(&#x27;.&#x27;).pop();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 // Easy case, it&#x27;s a TLD
 if (this.rules[host]){
   return true;
 }

 // Popping only the TLD of the hostname
 hostTld = tld.<span class="apidocCodeKeywordSpan">extractTldFromHost</span>(host);

 return this.rules[hostTld] !== undefined;
};

/**
* Returns the public suffix (including exact matches)
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.getCandidateRule" id="apidoc.element.tldjs.tld.getCandidateRule">
        function <span class="apidocSignatureSpan">tldjs.tld.</span>getCandidateRule
        <span class="apidocSignatureSpan">(host, rules, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getCandidateRule(host, rules, options) {
  var rule = {&#x27;normal&#x27;: null, &#x27;exception&#x27;: null};

  options = options || { lazy: false };

  _someFunction(rules, function (r) {
    var pattern;

    // sld matching or validHost? escape the loop immediately (except if it&#x27;s an exception)
    if (&#x27;.&#x27; + host === r.getNormalXld()) {
      if (options.lazy || r.exception || r.isHost) {
        rule.normal = r;
      }

      return true;
    }

    // otherwise check as a complete host
    // if it&#x27;s an exception, we want to loop a bit more to a normal rule
    pattern = &#x27;.+&#x27; + r.getNormalPattern() + &#x27;$&#x27;;

    if ((new RegExp(pattern)).test(host)) {
      rule[r.exception ? &#x27;exception&#x27; : &#x27;normal&#x27;] = r;
      return !r.exception;
    }

    return false;
  });

  // favouring the exception if encountered
  // previously we were copy-altering a rule, creating inconsistent results based on rule order order
  // @see https://github.com/oncletom/tld.js/pull/35
  if (rule.normal &#x26;&#x26; rule.exception) {
    return rule.exception;
  }

  return rule.normal;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (host in this.rules){
	  return host;
  }

  host = tld.cleanHostValue(host);
  hostTld = tld.extractTldFromHost(host);
  rules = this.getRulesForTld(hostTld);
  rule = tld.<span class="apidocCodeKeywordSpan">getCandidateRule</span>(host, rules, { lazy: true });

  if (rule === null) {
    return null;
  }

  return rule.getNormalXld().slice(1);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.init" id="apidoc.element.tldjs.tld.init">
        function <span class="apidocSignatureSpan">tldjs.tld.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function init() {
  return new tld();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...





&#x22;use strict&#x22;;

var tld = require(&#x27;./lib/tld.js&#x27;).<span class="apidocCodeKeywordSpan">init</span>();
tld.rules = require(&#x27;./rules.json&#x27;);

module.exports = tld;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.tld.prototype" id="apidoc.module.tldjs.tld.prototype">module tldjs.tld.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.getDomain" id="apidoc.element.tldjs.tld.prototype.getDomain">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getDomain
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDomain(host) {
  var domain = null, hostTld, rules, rule;

  if (this.isValid(host) === false) {
    return null;
  }

  host = tld.cleanHostValue(host);
  hostTld = tld.extractTldFromHost(host);
  rules = this.getRulesForTld(hostTld, new Rule({&#x22;firstLevel&#x22;: hostTld, &#x22;isHost&#x22;: this.validHosts.indexOf(hostTld) !== -1}));
  rule = tld.getCandidateRule(host, rules);

  if (rule === null) {
    return null;
  }

  host.replace(new RegExp(rule.getPattern()), function (m, d) {
    domain = d;
  });

  return domain;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
# Using It

## Node.js

```javascript
var tld = require(&#x27;tldjs&#x27;);

tld.<span class="apidocCodeKeywordSpan">getDomain</span>(&#x27;mail.google.co.uk&#x27;);
// -&#x3e; &#x27;google.co.uk&#x27;
```

## Browser

A browser version is made available thanks to [Browserify CDN](http://wzrd.in/).
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.getPublicSuffix" id="apidoc.element.tldjs.tld.prototype.getPublicSuffix">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getPublicSuffix
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getPublicSuffix(host) {
  var hostTld, rules, rule;

  if (host in this.rules){
	  return host;
  }

  host = tld.cleanHostValue(host);
  hostTld = tld.extractTldFromHost(host);
  rules = this.getRulesForTld(hostTld);
  rule = tld.getCandidateRule(host, rules, { lazy: true });

  if (rule === null) {
    return null;
  }

  return rule.getNormalXld().slice(1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

## getPublicSuffix()

Returns the public suffix for a given host.

```javascript
tld.<span class="apidocCodeKeywordSpan">getPublicSuffix</span>(&#x27;google.com&#x27;); // returns `com`
tld.getPublicSuffix(&#x27;fr.google.com&#x27;); // returns `com`
tld.getPublicSuffix(&#x27;google.co.uk&#x27;); // returns `co.uk`
tld.getPublicSuffix(&#x27;s3.amazonaws.com&#x27;); // returns `s3.amazonaws.com`
```

## isValid()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.getRulesForTld" id="apidoc.element.tldjs.tld.prototype.getRulesForTld">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getRulesForTld
        <span class="apidocSignatureSpan">(tld, default_rule)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getRulesForTld(tld, default_rule) {
  var exception = &#x27;!&#x27;;
  var wildcard = &#x27;*&#x27;;
  var append_tld_rule = true;
  var rules = this.rules[tld];

  // Already parsed
  // Array.isArray polyfill for IE8
  if (Object.prototype.toString.call(rules)  === &#x27;[object Array]&#x27;) {
    return rules;
  }

  // Nothing found, apply some default value
  if (rules === void 0) {
    return default_rule ? [ default_rule ] : [];
  }

  // Parsing needed
  rules = _mapFunction(rules.split(&#x27;|&#x27;), function transformAsRule (sld) {
    var first_bit = sld[0];

    if (first_bit === exception || first_bit === wildcard) {
      sld = sld.slice(1);

      if (!sld) {
        append_tld_rule = false;
      }
    }

    return new Rule({
      &#x22;firstLevel&#x22;:  tld,
      &#x22;secondLevel&#x22;: sld,
      &#x22;exception&#x22;:   first_bit === exception,
      &#x22;wildcard&#x22;:    first_bit === wildcard
    });
  });

  // Always prepend to make it the latest rule to be applied
  if (append_tld_rule) {
    rules.unshift(new Rule({
      &#x22;firstLevel&#x22;: tld
    }));
  }

  this.rules[tld] = rules.reverse();

  return rules;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (host in this.rules){
	  return host;
}

host = tld.cleanHostValue(host);
hostTld = tld.extractTldFromHost(host);
rules = this.<span class="apidocCodeKeywordSpan">getRulesForTld</span>(hostTld);
rule = tld.getCandidateRule(host, rules, { lazy: true });

if (rule === null) {
  return null;
}

return rule.getNormalXld().slice(1);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.getSubdomain" id="apidoc.element.tldjs.tld.prototype.getSubdomain">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>getSubdomain
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getSubdomain(host){
  var domain, r, subdomain;

  host = tld.cleanHostValue(host);
  domain = this.getDomain(host);

  // No domain found? Just abort, abort!
  if (domain === null){
    return null;
  }

  r = &#x27;\\.?&#x27;+ tld.escapeRegExp(domain)+&#x27;$&#x27;;
  subdomain = host.replace(new RegExp(r, &#x27;i&#x27;), &#x27;&#x27;);

  return subdomain;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

## getSubdomain()

Returns the complete subdomain for a given host.

```javascript
tld.<span class="apidocCodeKeywordSpan">getSubdomain</span>(&#x27;google.com&#x27;); // returns ``
tld.getSubdomain(&#x27;fr.google.com&#x27;); // returns `fr`
tld.getSubdomain(&#x27;google.co.uk&#x27;); // returns ``
tld.getSubdomain(&#x27;foo.google.co.uk&#x27;); // returns `foo`
tld.getSubdomain(&#x27;moar.foo.google.co.uk&#x27;); // returns `moar.foo`
tld.getSubdomain(&#x27;t.co&#x27;); // returns ``
tld.getSubdomain(&#x27;fr.t.co&#x27;); // returns `fr`
tld.getSubdomain(&#x27;https://user:password@example.co.uk:8080/some/path?and&#x26;query#hash&#x27;); // returns ``
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.isValid" id="apidoc.element.tldjs.tld.prototype.isValid">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>isValid
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isValid(host) {
  return typeof host === &#x27;string&#x27; &#x26;&#x26; (this.validHosts.indexOf(host) !== -1 || (host.indexOf(&#x27;.&#x27;) !== -1 &#x26;&#x26; host[0] !== &#x27;.&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## isValid()

Checks if the host string is valid.
It does not check if the *tld* exists.

```javascript
tld.<span class="apidocCodeKeywordSpan">isValid</span>(&#x27;google.com&#x27;); // returns `true`
tld.isValid(&#x27;.google.com&#x27;); // returns `false`
tld.isValid(&#x27;my.fake.domain&#x27;); // returns `true`
tld.isValid(&#x27;localhost&#x27;); // returns `false`
tld.isValid(&#x27;https://user:password@example.co.uk:8080/some/path?and&#x26;query#hash&#x27;); // returns `true`
```

# Troubleshouting
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.tldjs.tld.prototype.tldExists" id="apidoc.element.tldjs.tld.prototype.tldExists">
        function <span class="apidocSignatureSpan">tldjs.tld.prototype.</span>tldExists
        <span class="apidocSignatureSpan">(host)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function tldExists(host){
  var hostTld;

  host = tld.cleanHostValue(host);

  // Easy case, it&#x27;s a TLD
  if (this.rules[host]){
    return true;
  }

  // Popping only the TLD of the hostname
  hostTld = tld.extractTldFromHost(host);

  return this.rules[hostTld] !== undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
# API

## tldExists()

Checks if the TLD is valid for a given host.

```javascript
tld.<span class="apidocCodeKeywordSpan">tldExists</span>(&#x27;google.com&#x27;); // returns `true`
tld.tldExists(&#x27;google.local&#x27;); // returns `false` (not an explicit registered TLD)
tld.tldExists(&#x27;com&#x27;); // returns `true`
tld.tldExists(&#x27;uk&#x27;); // returns `true`
tld.tldExists(&#x27;co.uk&#x27;); // returns `true` (because `uk` is a valid TLD)
tld.tldExists(&#x27;amazon.fancy.uk&#x27;); // returns `true` (still because `uk` is a valid TLD)
tld.tldExists(&#x27;amazon.co.uk&#x27;); // returns `true` (still because `uk` is a valid TLD)
tld.tldExists(&#x27;https://user:password@example.co.uk:8080/some/path?and&#x26;query#hash&#x27;); // returns `true`
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.tldjs.update" id="apidoc.module.tldjs.update">module tldjs.update</a></h1>


    <h2>
        <a href="#apidoc.element.tldjs.update.run" id="apidoc.element.tldjs.update.run">
        function <span class="apidocSignatureSpan">tldjs.update.</span>run
        <span class="apidocSignatureSpan">(done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function runUpdater(done){
  done = typeof done === &#x27;function&#x27; ? done : function(){};

  var req = http.request(providerUrl, function (res) {
    var body = &#x27;&#x27;;

    if (res.statusCode !== 200) {
      res.destroy();
      return done(new Error(&#x27;tldjs: remote server responded with HTTP status &#x27; + res.statusCode));
    }

    res.setEncoding(&#x27;utf8&#x27;);

    res.on(&#x27;data&#x27;, function(d) {
      body += d;
    });

    res.on(&#x27;end&#x27;, function() {
      var tlds = parser.parse(body);
      var task_result = exportTask(tlds);
      var filename = task_result[0];
      var data = task_result[1];

      data = JSON.stringify(data);

      fs.writeFile(join(__dirname, &#x27;..&#x27;, filename), data, &#x27;utf-8&#x27;, done);
    });
  });

  req.setTimeout(5000);
  req.on(&#x27;error&#x27;, done);
  req.end();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var updater = require(&#x27;./update.js&#x27;);
var SHOULD_UPDATE = process.env.npm_config_tldjs_update_rules === &#x27;true&#x27;;


if (SHOULD_UPDATE) {
  console.log(&#x27;tldjs: updating rules from %s.&#x27;, updater.providerUrl);

  updater.<span class="apidocCodeKeywordSpan">run</span>(function(err){
if (err) {
  console.error(err.message);
  process.exit(err.code);
}

console.log(&#x27;tldjs: rules list updated.&#x27;);
process.exit(0);
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
